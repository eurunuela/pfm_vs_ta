% !TEX root = ../main.tex

\section{Introduction}

% \begin{itemize}

%     \item Talk about our motivation for this paper.

%     \item We could mention iCAPs Neuron, and papers with applications like PFM, TA, clinical patient papers with iCAPs.

%     \item Apart from [[Richard F. Betzel]]'s work~\citealt{betzel2020temporal,esfahlani2020high,faskowitz2020edge}, we could mention the connection with the
%     [[Multiplication of Temporal Derivatives]] method~\citealt{shine2015estimation,shine2016dynamics}.

%     \begin{itemize}
%         \item These are basically calculating the derivative, which is the same as applying a high-pass filter and calculating the correlation.
%     \end{itemize}

% \end{itemize}

% Footnote example
% \fntext[myfootnote]{Since 1880.}

Functional magnetic resonance imaging (fMRI) data analysis is often directed to identify and disentangle the neural processes that occur in different brain regions during task or at rest. As the blood oxygenation level-dependent (BOLD) signal of fMRI is only a proxy for neuronal activity mediated through neurovascular coupling, an intermediate step that estimates the activity-inducing signal, at the timescale of fMRI, from the BOLD timeseries can be useful. Conventional analysis of task fMRI data relies on the general linear models (GLM) to establish statistical parametric maps of brain activity by regression of the empirical timecourses against hypothetical ones built from the knowledge of the experimental paradigm. However, timing information of the paradigm can be unknown, inaccurate, or insufficient in some scenarios such as naturalistic stimuli, resting-state, or clinically-relevant assessments.

Deconvolution and methods alike are aiming to estimate neuronal activity by undoing the blurring effect of the hemodynamic response, characterized as a hemodynamic response function (HRF). Given the inherently ill-posed nature of hemodynamic deconvolution, due to the strong temporal low-pass characteristics of the HRF, the key is to introduce additional constraints in the estimation problem that are typically expressed as regularizers. For instance, the so-called Wiener deconvolution is expressing a ``minimal energy'' constraint on the deconvolved signal, and has been used in the framework of psychophysiological interactions analysis to compute the interaction between a seed's activity timecourse and an experimental modulation (\citealt{glover1999deconvolution,gitelman2003ModelingRegionalPsychophysiologic,Di2019,Gerchen2014,Freitas2020}). Complementarily, the interest in deconvolution has increased to explore time-varying activity in resting-state fMRI data (\citealt{Bolton2020,Preti2017,Keilholz2017,Lurie2020}). In that case, the aim is to gain better insights into the neural signals that drive functional connectivity at short time scales, as well as how the spatio-temporal structure of functional components that dynamically construct resting-state networks and their interactions (\citealt{karahanoglu2017DynamicsLargescalefMRI}).

Deconvolution of the resting-state fMRI signal has illustrated the significance of transient, sparse spontaneous events (\citealt{petridou2013PeriodsRestfMRI,allan2015FunctionalConnectivityMRI}) that refine the hierarchical clusterization of functional networks (\citealt{karahanoglu2013TotalActivationfMRI}) and reveal their temporal overlap based on their signal innovations not only in the human brain (\citealt{karahanoglu2015TransientBrainActivity}), but also in the spinal cord (\citealt{kinany2020DynamicFunctionalConnectivity}). Similar to task-related studies, deconvolution allows to investigate modulatory interactions within and between resting-state functional networks (\citealt{Di2013,Di2015}). In addition, decoding of the deconvolved spontaneous events allows to decipher the flow of spontaneous thoughts across cognitive domains while at rest (\citealt{gonzalez-castillo2019ImagingSpontaneousFlow,karahanoglu2015TransientBrainActivity}).

Beyond findings on healthy subjects, deconvolution techniques has proven its utility in clinical conditions to characterize functional alterations of patients with a progressive stage of multiple sclerosis at rest (\citealt{bommarito2020FunctionalNetworkDynamicsa}), to find functional signatures of prodromal psychotic symptoms and anxiety at rest on patients suffering from schizophrenia (\citealt{zoller2019LargeScaleBrainNetwork}), to detect the foci of interictal events in epilepsy patients without an EEG recording (\citealt{lopes2012DetectionEpilepticActivity,karahanouglu2013spatial}), or to study functional dissociations observed during non-rapid eye movement sleep that are associated with reduced consolidation of information and impaired consciousness (\citealt{tarun2021NREMSleepStagesa}).

The algorithms for hemodynamic deconvolution can be classified based on the assumed hemodynamic model and the optimization problem used to estimate the neuronal-related signal. Most approaches assume a linear time-invariant model for the hemodynamic response that is inverted by means of variational (regularized) least squares estimators (\citealt{glover1999deconvolution,gitelman2003ModelingRegionalPsychophysiologic,karahanoglu2013TotalActivationfMRI,gaudes2011DetectionCharacterizationSingletrial,caballero-gaudes2019DeconvolutionAlgorithmMultiecho,caballerogaudes2013ParadigmFreeMapping,gaudes2012StructuredSparseDeconvolution,cherkaoui2019SparsitybasedBlindDeconvolution,hernandez2011neuronal,costantini2021,Huetel2021}, logistic functions (\citealt{Bush2013,Bush2015a,Loula2018}), probabilistic mixture models (\cite{pidnebesna2019}), convolutional autoencoders (\citealt{hutel2018neural}) or nonparametric homomorphic filtering (\citealt{Sreenivasan2015}). Alternatively, several methods have also been proposed to invert non-linear models of the neuronal and hemodynamic coupling (\citealt{Riera2004,Friston2008,Havlicek2011,Aslan2016,Madi2017,RuizEuler2018}). 

Among the variety of approaches, those based on regularized least squares estimators have been more applied in multiple studies probably due to their ability to operate at small spatial scales (e.g. voxelwise) with appropriate performance. Relevant for this work, two different formulations can be established for the regularized least squares problem, either based on a synthesis-based model \citealt{} or an analysis-based model \citealt{}.

A series of recent studies have attempted to understand neural processes by studying the interactions between BOLD responses without estimating the underlying neuronal activity. For instance, co-activation patterns have been used to replicate seed correlation-based resting-state functional networks with a small portion of the data (\citealt{liu2013time,liu2013decomposition,liu2018co,majeed2009spatiotemporal,majeed2011spatiotemporal,cifre2020revisiting,cifre2020further,zhang2020relationship}). Likewise, the dynamics of functional connectivity have recently been investigated with the use of co-fluctuations and edge-centric techniques on tasks (\citealt{faskowitz2021EdgecentricModelHarmonizing}), resting-state (\citealt{zamaniesfahlani2020HighamplitudeCofluctuationsCortical}) and naturalistic paradigms (\citealt{faskowitz2020EdgecentricFunctionalNetwork,betzel2020TemporalFluctuationsBrain}). %Methods based on the multiplication of temporal derivatives have also been presented for the estimation of dynamic functional connectivity on task fMRI data (\citealt{shine2015estimation,shine2016dynamics}).

This note revisits synthesis- and analysis-based deconvolution methods for fMRI data and comprises four sections. In the first, we present the theory behind two state-of-the-art deconvolution approaches based on estimators that promote sparsity: Paradigm Free Mapping (PFM) (\citealt{caballerogaudes2013ParadigmFreeMapping}) --- available in AFNI as \textit{3dPFM} and \textit{3dMEPFM} for single-echo and multi-echo data, respectively --- and Total Activation (TA) (\citealt{karahanoglu2013TotalActivationfMRI}) --- available as part of the \textit{iCAPs toolbox}. We then assess their performance controlling for a fair comparison on simulated and experimental data. Finally, we discuss the benefits and shortcomings of each technique and conclude with our vision on potential extensions and developments.
