% !TEX root = ../main.tex

\section{Discussion}

% New command for table
\newcommand\pro{\item[$+$]}
\newcommand\con{\item[$-$]}

% \begin{itemize}
%     \item Pros and cons of each formulation: analysis vs synthesis
%     \item Link with other approaches
%     \item Finish with conclusions and a moving forward
%     \begin{itemize}
%         \item We have to refine the deconvolution
%         \item HRF variability there are three: conference proceeding by Philippe~\citealt{badillo2013group}, ISBI 2012 by CÃ©sar~\citealt{gaudes2012structured}, and Farouj with a different formulation. Say conceptual differences among those.
%         \item Mention stability-selection~\citealt{meinshausen2010stability}
%         \item Debiasing
%         \item Connected to debiasing other deconvolution algorithms that are based on a norm lower than 1.
%     \end{itemize}
% \end{itemize}

% \begin{table}
%     \centering
%     \begin{tabular}{ m{4cm} m{4cm} }
%         Paradigm Free Mapping & Total Activation \\
%         \toprule
%         \begin{itemize}
%             \pro Its formulation can be extended straightforwardly for deconvolution of multiple signals with a common neuronal-related signal, e.g., for multi-echo formulations \citealt{caballero-gaudes2019DeconvolutionAlgorithmMultiecho}.
%             \pro The model can implement any HRF shape very easily since it only requires the coefficients at the required temporal resolution.
%             \con 
%         \end{itemize} &
%         \begin{itemize}
%             \pro Both the spike and block models solve the regularization problem with the same HRF.
%             \con 
%         \end{itemize} \\
%     \end{tabular}
%     \caption{Advantages (+) and disadvantages (-) of Paradigm Free Mapping and Total Activation with respect to each other.}
%     \label{tab:proscons}
% \end{table}
\todo[inline]{Folks, I think we need to polish the message for the reader further. If the methods are equivalent, either the reader has learned something about different types of optimization (but this is not yet well described in the paper), or there is a clear practical take-home message.}

This work demonstrates that PFM and TA algorithms yield practically identical results when the same HRF model and equivalent regularization parameters are employed, demonstrating that synthesis and analysis-based formulations are comparable for temporal hemodynamic deconvolution of fMRI data under a linear-time invariant model of the neurovascular coupling. Hence, we argue that previously observed differences in performance can be explained in terms of differences in usage options, such as the specific HRF model and selection of the regularization parameter, convergence thresholds, as well as the addition of a spatial regularization term by TA as described in \citealt{Karahanoglu2013TotalactivationfMRI}. With the equivalence in the temporal deconvolution demonstrated, incorporating extra spatial or temporal regularization terms in the optimization problem would not modify this equivalence providing convex operators are employed. In terms of convergence, this equivalence is particularly relevant when the convex optimization problem (i.e. with a unique global solution) is solved by means of iterative shrinkage thresholding procedures that alternate between the different regularization terms of the functional, such as the Generalized Forward-Backward Splitting (\citealt{Raguet2013GeneralizedForwardBackward}) technique originally proposed for TA. Our findings are in line with the equivalence of analysis and synthesis methods in under-determined cases (\(N \leq V\)) demonstrated in (\citealt{Elad2007Analysisversussynthesis}) and (\citealt{ortelli2019synthesis}).

Nevertheless, the differences between analysis and synthesis deconvolution methods must be considered to achieve optimal performance with any research question in hand. For instance, while TA uses the same HRF to solve both the spike and block models using the Generalized Total Variation formulation \citealt{Karahanoglu2011SignalProcessingApproach}), PFM incorporates the discrete differentiator operator into forward model along with the HRF to estimate innovation signals. The more flexible approach adopted by PFM offers the advantage that the synthesis operator allows for any HRF shape (\citealt{Elad2007Analysisversussynthesis}), only requiring that the coefficients are given at the desired temporal resolution of the deconvolved estimates, which is typically equal to TR of the acquisition\todo{Dimitri, could you write a sentence about the requirements for the HRF filter, for instance that the hemodynamic operator must be defined in terms of zeros and poles}. Given its more intuitive and versatile structure, the synthesis formulation proposed by PFM can easily be extended for deconvolution of multiple fMRI inputs with a common neuronal-related signal, for example for the estimation of neuronal-related events on multi-echo data (\citealt{CaballeroGaudes2019deconvolutionalgorithmmulti})\todo{Dimitri: Do you agree that a multivariate deconvolution as in multi-echo would be more difficult to formulate with the total variation formulation?}.


At the same time, deconvolution techniques can be used prior to the analysis of functional networks as they estimate interactions between brain regions that occur at the neuronal level, which are significantly less affected the slugginess of the hemodynamic response and confounding effects than directly analyzing hemodynamic interactions (\citealt{Gitelman2003Modelingregionalpsychophysiologic}). In addition, deconvolution approaches have a close parallelism to recent methodologies aiming to understand the dynamics of neuronal activations and interactions at short temporal resolution and that focus on extreme events in the fMRI signal. For example, Figure 6 illustrates that the innovation- or activity-inducing CAPs computed from deconvolved events in a single resting-state fMRI dataset closely resemble the conventional CAPs computed directly from extreme events of the fMRI signal (\citealt{Liu2013Timevaryingfunctional,Liu2013Decompositionspontaneousbrain,Liu2018Coactivationpatterns,cifre2020revisiting,Cifre2020Furtherresultswhy,Zhang2020relationshipBOLDneural,Tagliazucchi2011,Tagliazucchi2012,Tagliazucchi2016,Rolls2021}). Similarly, we hypothesize that these extreme events will also show a close resemblance to intrinsic ignition events (\citealt{Deco2017a,Deco2017}). As shown in the maps, deconvolution approaches can offer a more straightforward interpretability of the activation events and resulting functional connectivity patterns. For the sake of illustration, CAPs were computed here as the average of spatial maps corresponding to the events of a single dataset. Beyond simple averaging, other clustering algorithms (e.g. K-means, consensus clustering) can be employed to discern multiple CAPs at the whole-brain level when a larger number of subjects or datasets is available (e.g. see \citealt{Karahanoglu2015Transientbrainactivity}). Likewise, the dynamics of functional connectivity have recently been investigated with the use of co-fluctuations and edge-centric techniques (\citealt{Faskowitz2020,Esfahlani2020Highamplitudecofluctuations,Jo2021,Sporns2021}). The Activation Time Series shown in Figure 5 aim to offer equivalent information of instances of signficant brain activity to the root of sum of squares timecourses used in edge-centric approaches. Future work could address which type of information is redundant or distinct across frameworks. In summary, these examples illustrate that deconvolution techniques can be employed prior to other computational approaches and could serve as an effective way of denoising the fMRI data. We foresee an increase in the number of studies that take advantage of the potential benefits of using deconvolution methods prior to functional connectivity analyses.

Finally, taking into account the equivalent performance of analysis and synthesis deconvolution approaches, and the advantages and disadvantages discussed here, it is clear that fMRI deconvolution methods still have room for improvement and their capabilities can be extended to reach a wider community of researchers. Of particular relevance are deconvolution formulations aiming to account for HRF variability, for example using structured regularization terms along with multiple basis functions (\citealt{Gaudes2012Structuredsparsedeconvolution}) or iterative procedures that estimate the HRF shape in an iterative fashion \citealt{Farouj2019BoldSignalDeconvolution,cherkaoui:hal-03005584}. Another venue of research are multivariate deconvolution approaches that operate at the whole-brain level, instead of voxelwise, for instance using low rank decompositions (\citealt{cherkaoui:hal-03005584}) or group (a.k.a. mixed norm) regularization terms\todo{Add your ISMRM abstract for multivariate deconvolution}. Methods for a more robust selection of the regularization parameter could also be explored, for instance based on stability selection (\citealt{Meinshausen2010Stabilityselection,Urunuela2020StabilityBasedSparse}). Furthermore, the use of non-convex \(\ell_{p,q}\)-norm regularization terms (e.g., \(p < 1\)) could avoid the extra debiasing step that is necessary to overcome the shrinkage towards zero of the estimates \citealt{Gaudes2013Paradigmfreemapping,CaballeroGaudes2019deconvolutionalgorithmmulti}. Alternatively, recent developments on physics-informed deep learning for inverse problems (\citealt{Akcakaya2021,Monga2021,Ongie2020}) could become an interesting venue of research to reduce the computational time and gain flexibility.