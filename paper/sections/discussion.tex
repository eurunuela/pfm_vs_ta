% !TEX root = ../main.tex

\section{Discussion}

% New command for table
\newcommand\pro{\item[$+$]}
\newcommand\con{\item[$-$]}

% \begin{itemize}
%     \item Pros and cons of each formulation: analysis vs synthesis
%     \item Link with other approaches
%     \item Finish with conclusions and a moving forward
%     \begin{itemize}
%         \item We have to refine the deconvolution
%         \item HRF variability there are three: conference proceeding by Philippe~\citealt{badillo2013group}, ISBI 2012 by CÃ©sar~\citealt{gaudes2012structured}, and Farouj with a different formulation. Say conceptual differences among those.
%         \item Mention stability-selection~\citealt{meinshausen2010stability}
%         \item Debiasing
%         \item Connected to debiasing other deconvolution algorithms that are based on a norm lower than 1.
%     \end{itemize}
% \end{itemize}

% \begin{table}
%     \centering
%     \begin{tabular}{ m{4cm} m{4cm} }
%         Paradigm Free Mapping & Total Activation \\
%         \toprule
%         \begin{itemize}
%             \pro Its formulation can be extended straightforwardly for deconvolution of multiple signals with a common neuronal-related signal, e.g., for multi-echo formulations \citealt{caballero-gaudes2019DeconvolutionAlgorithmMultiecho}.
%             \pro The model can implement any HRF shape very easily since it only requires the coefficients at the required temporal resolution.
%             \con 
%         \end{itemize} &
%         \begin{itemize}
%             \pro Both the spike and block models solve the regularization problem with the same HRF.
%             \con 
%         \end{itemize} \\
%     \end{tabular}
%     \caption{Advantages (+) and disadvantages (-) of Paradigm Free Mapping and Total Activation with respect to each other.}
%     \label{tab:proscons}
% \end{table}
\todo[inline]{Folks, I think we need to polish the message for the reader further. If the methods are equivalent, either the reader has learned something about different types of optimization (but this is not yet well described in the paper), or there is a clear practical take-home message.}

This work demonstrates that PFM and TA yield practically identical results when the same HRF model and equivalent regularization parameters are employed, demonstrating that synthesis and analysis models are comparable for temporal deconvolution of fMRI data. Hence, we argue that previously observed differences in performance must be due to differences in usage options and the addition of a spatial regularization term by TA. With the equivalence in the temporal deconvolution demonstrated, it is reasonable to assume that additional regularization terms in the spatial or temporal domains would not modify this equivalence when convex operators are employed; e.g., when the regularization problem can be solved by means of the Fast Iterative Shrinkage-Thresholding Algorithm (FISTA) (\citealt{Beck2009FastIterativeShrinkage}) or the Generalized Forward-Backward Splitting (\citealt{Raguet2013GeneralizedForwardBackward}) techniques. Our findings are in line with the equivalence of analysis and synthesis methods in under-determined cases (\(N \leq V\)) demonstrated in (\citealt{Elad2007Analysisversussynthesis}) and (\citealt{ortelli2019synthesis}).

Nevertheless, to achieve optimal performance with any research question in hand, the differences between analysis and synthesis deconvolution methods must be considered. For instance, while TA uses the same HRF to solve both the spike and block models, PFM requires that a modified version of the canonical HRF is used to estimate innovation signals. However, this can be seen as an advantage, since the synthesis operator allows for any HRF shape, only requiring that the coefficients are given on the correct temporal resolution. Given its more intuitive and versatile strucutre, the synthesis formulation proposed by PFM can easily be extended for the deconvolution of multiple inputs with a common neuronal-related signal, e.g., for the estimation of neuronal-related events on multi-echo data (\citealt{CaballeroGaudes2019deconvolutionalgorithmmulti}).

At the same time, deconvolution techniques can be used to denoise the data prior to the analysis of functional networks as they estimate interactions between brain regions that occur at the neuronal level, which are significantly less affected by noise than hemodynamic interactions (\citealt{Gitelman2003Modelingregionalpsychophysiologic}). This is of particular interest, as a series of recent studies have attempted to understand neural processes by studying the interactions between BOLD responses without estimating the underlying neuronal activity. For instance, CAPs have been used to replicate seed correlation-based resting-state functional networks with a small portion of the data (\citealt{Liu2013Timevaryingfunctional,Liu2013Decompositionspontaneousbrain,Liu2018Coactivationpatterns,Majeed2009Spatiotemporaldynamicslow,Majeed2011Spatiotemporaldynamicslow,cifre2020revisiting,Cifre2020Furtherresultswhy,Zhang2020relationshipBOLDneural}). Likewise, the dynamics of functional connectivity have recently been investigated with the use of co-fluctuations and edge-centric techniques on tasks (\citealt{Faskowitz2021edgecentricmodel}), resting-state (\citealt{Esfahlani2020Highamplitudecofluctuations}) and naturalistic paradigms (\citealt{Faskowitz2020Edgecentricfunctional,Betzel2020Temporalfluctuationsbrains}). Methods based on the multiplication of temporal derivatives have also been presented for the estimation of dynamic functional connectivity on task fMRI data (\citealt{Shine2015Estimationdynamicfunctional,Shine2016DynamicsFunctionalBrain}). However, the number of studies that take advantage of the potential benefits of using deconvolution methods prior to the analysis of functional connectivity has been scarce.

Finally, taking into account the equivalent performance of analysis and synthesis deconvolution approaches, and the advantages and disadvantages discussed here, it is clear that fMRI deconvolution methods still have room for improvement and their capabilities can be extended to reach a wider community of researchers. For instance, the appropriate formulation for various data acquisition techniques (i.e., single-echo vs multi-echo) could be studied and compared with existing methods (\citealt{CaballeroGaudes2019deconvolutionalgorithmmulti}), or formulations that account for HRF variability could be investigated too (\citealt{Gaudes2012Structuredsparsedeconvolution,Badillo2013Grouplevelimpacts,Farouj2019BoldSignalDeconvolution}). Furthermore, robust methods to select the regularization parameter (\citealt{Meinshausen2010Stabilityselection,Urunuela2020StabilityBasedSparse}) and other potential \(\ell_{p,q}\)-norm regularization terms (e.g., \(p < 1\)) or debiasing approaches could be explored to further improve the accuracy of deconvolution techniques.
