% !TEX root = ../main.tex

\section{Discussion}

% New command for table
% \newcommand\pro{\item[$+$]}
% \newcommand\con{\item[$-$]}

% \begin{itemize}
%     \item Pros and cons of each formulation: analysis vs synthesis
%     \item Link with other approaches
%     \item Finish with conclusions and a moving forward
%     \begin{itemize}
%         \item We have to refine the deconvolution
%         \item HRF variability there are three: conference proceeding by Philippe~\citealt{badillo2013group}, ISBI 2012 by CÃ©sar~\citealt{gaudes2012structured}, and Farouj with a different formulation. Say conceptual differences among those.
%         \item Mention stability-selection~\citealt{meinshausen2010stability}
%         \item Debiasing
%         \item Connected to debiasing other deconvolution algorithms that are based on a norm lower than 1.
%     \end{itemize}
% \end{itemize}

% \begin{table}
%     \centering
%     \begin{tabular}{ m{4cm} m{4cm} }
%         Paradigm Free Mapping & Total Activation \\
%         \toprule
%         \begin{itemize}
%             \pro Its formulation can be extended straightforwardly for deconvolution of multiple signals with a common neuronal-related signal, e.g., for multi-echo formulations \citealt{caballero-gaudes2019DeconvolutionAlgorithmMultiecho}.
%             \pro The model can implement any HRF shape very easily since it only requires the coefficients at the required temporal resolution.
%             \con 
%         \end{itemize} &
%         \begin{itemize}
%             \pro Both the spike and block models solve the regularization problem with the same HRF.
%             \con 
%         \end{itemize} \\
%     \end{tabular}
%     \caption{Advantages (+) and disadvantages (-) of Paradigm Free Mapping and Total Activation with respect to each other.}
%     \label{tab:proscons}
% \end{table}

Hemodynamic deconvolution can be formulated using a synthesis- and analysis-based approach, which was proposed by PFM and TA, respectively. This work demonstrates that the theoretical equivalence of PFM and TA is confirmed in practice given virtually identical results when the same HRF model and equivalent regularization parameters are employed. Hence, we argue that previously observed differences in performance can be explained by specific settings, such as the HRF model and selection of the regularization parameter, convergence thresholds, as well as the addition of a spatial regularization term in the spatiotemporal TA formulation \citealt{Karahanoglu2013TotalactivationfMRI}. However, given the equivalence of the temporal deconvolution, incorporating extra spatial or temporal regularization terms in the optimization problem should not modify this equivalence providing convex operators are employed. For a convex optimization problem, with a unique global solution, iterative shrinkage thresholding procedures alternating between the different regularization terms guarantee convergence; e.g., the generalized forward-backward splitting (\citealt{Raguet2013GeneralizedForwardBackward}) algorithm originally employed for TA. Our findings are in line with the equivalence of analysis and synthesis methods in under-determined cases (\(N \leq V\)) demonstrated in (\citealt{Elad2007Analysisversussynthesis}) and (\citealt{ortelli2019synthesis}).\todo{Do you think we need to discuss the small differences observed with the block model for the MAD criterion? -- yes, would be good to add 1-2 sentences}

Nevertheless, the different formulations of analysis and synthesis deconvolution models bring along different kinds of flexibility. One notable advantage of PFM is that it can readily incorporate any HRF as part of the synthesis operator (\citealt{Elad2007Analysisversussynthesis}), only requiring the sampled HRF at the desired temporal resolution, which is typically equal to the TR of the acquisition. Conversely, TA relies upon the specification of the discrete differential operator that inverts the HRF, which needs to be derived either by the inverse solution of the sampled HRF impulse response, or by discretizing a continuous-domain differential operator motivated by a biophysical model. This more versatile structure of PFM allows for instance an elegant extension of the algorithm for multi-echo fMRI data (\citealt{CaballeroGaudes2019deconvolutionalgorithmmulti}) where multiple measurements relate to a common underlying signal. Such one-to-many (i.e., from activity-inducing to several activity-related signals) formulation cannot be elegantly enforced using TA. \todo{This is indeed a nice advantage of PFM! Would be possible but more artificial with TA.}
One flexibility of TA though is the specification of block models through the derivative instead of the integrator of PFM, which impacts the stability and rate of the convergence of the algorithms. Extensions using combinations of spike and block regularizers are also easier to conceive using TA. 
\todo[inline]{The other point to further briefly develop here would be which type of optimization algorithms are accessible by both formulations. This would be an excellent point to be addressed by Younes. From what Hamza's PhD, the analysis formulation allows to use algorithms that are particularly efficient (e.g., FISTA family), but those are not portable to the synthesis case.}

Deconvolution techniques can be used before more downstream analysis of brain activity in terms of functional network organization as they estimate interactions between voxels or brain regions that occur at the activity-inducing level, and thus less affected by the slowness of the hemodynamic response compared to when the BOLD signals are analyzed directly. In addition, deconvolution approaches hold a close parallelism to recent methodologies aiming to understand the dynamics of neuronal activations and interactions at short temporal resolution and that focus on extreme events of the fMRI signal\todo{A few other REFS too? Like the change-point method by Lindquist (10.1016/j.neuroimage.2007.01.004)}. As an illustration, Figure 6 shows that the innovation- or activity-inducing CAPs computed from deconvolved events in a single resting-state fMRI dataset closely resemble the conventional CAPs computed directly from extreme events of the fMRI signal (\citealt{Liu2013Timevaryingfunctional,Liu2013Decompositionspontaneousbrain,Liu2018Coactivationpatterns,cifre2020revisiting,Cifre2020Furtherresultswhy,Zhang2020relationshipBOLDneural,Tagliazucchi2011,Tagliazucchi2012,Tagliazucchi2016,Rolls2021}). Similarly, we hypothesize that these extreme events will also show a close resemblance to intrinsic ignition events (\citealt{Deco2017a,Deco2017}). As shown in the maps, deconvolution approaches can offer a more straightforward interpretability of the activation events and resulting functional connectivity patterns. Here, CAPs were computed as the average of spatial maps corresponding to the events of a single dataset. Beyond simple averaging, clustering algorithms (e.g., K-means and consensus clustering) can be employed to discern multiple CAPs or iCAPs at the whole-brain level for a large number of subjects. Previous findings based on iCAPs have for instance revealed organizational principles of brain function during rest (\citealt{Karahanoglu2015Transientbrainactivity}) and sleep (\citealt{tarun2101}) in healthy controls, next to alterations in 22q11ds (\citealt{zoller1902}) and multiple sclerosis (\citealt{bommarito2101p}). Next to CAPs-inspired approaches, dynamic functional connectivity have recently been investigated with the use of co-fluctuations and edge-centric techniques (\citealt{Faskowitz2020,Esfahlani2020Highamplitudecofluctuations,Jo2021,Sporns2021,Oort2018}). The activation time series shown in Figure 5 aims to provide equivalent information to the root of sum of squares timecourses used in edge-centric approaches, where timecourses with peaks delineate instances of significant brain activity. Future work could address which type of information is redundant or distinct across these frameworks. In summary, these examples illustrate that deconvolution techniques can be employed prior to other computational approaches and could serve as an effective way of denoising the fMRI data. We foresee an increase in the number of studies that take advantage of the potential benefits of using deconvolution methods prior to functional connectivity analyses.

In sum, hemodynamic deconvolution approaches using sparsity-driven regularization are valuable tools to complete the fMRI processing pipeline. Current approaches provide already access to alternative representations of the BOLD signals in terms of innovation and activity-inducing signals. One relevant focus for future developments is to account for HRF variability, such as by using structured regularization terms along with multiple basis functions (\citealt{Gaudes2012Structuredsparsedeconvolution}) or procedures that estimate the HRF shape in an iterative fashion (\citealt{Farouj2019BoldSignalDeconvolution,cherkaoui:hal-03005584}). Another avenue of research are multivariate deconvolution approaches that operate at the whole-brain level, instead of voxelwise, for instance using low rank decompositions (\citealt{cherkaoui:hal-03005584, Urunuela_2021}) or group (a.k.a. mixed norm) regularization terms (\citealt{urunuela-tremino_2019}). Methods for a more robust selection of the regularization parameter could also be explored, for instance, based on stability selection (\citealt{Meinshausen2010Stabilityselection,Urunuela2020StabilityBasedSparse}). Furthermore, the use of non-convex \(\ell_{p,q}\)-norm regularization terms (e.g., \(p < 1\)) could avoid the extra debiasing step that is necessary to overcome the shrinkage towards zero of the estimates and obtain a more accurate and less biased fit of the fMRI signal  (\citealt{Gaudes2013Paradigmfreemapping,CaballeroGaudes2019deconvolutionalgorithmmulti}). Alternatively, recent developments on physics-informed deep learning for inverse problems (\citealt{Akcakaya2021,Monga2021,Ongie2020}) could be transposed by consider the biophysical model of the hemodynamic system and potentially provide algorithms with reduced computational time and more flexibility. \todo{Cite unrolling method by Hamza here}